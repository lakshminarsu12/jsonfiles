Step 1 — Add Button in index.html (inside each grid-item)

<!-- Show Question Response Button only if JSON exists -->
<div class="question-data"
     th:if="${img.questionResponse != null and img.questionResponse != ''}">
    
    <button type="button"
            class="qr-button"
            th:onclick="|showQuestionResponse('${img.questionResponse}')|">
        View AI Result
    </button>

</div>


Step 2 — Add Modal Popup (once in the page, near bottom of body)

<!-- Modal -->
<div id="qrModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">×</span>
        <pre id="qrJsonDisplay"></pre>
    </div>
</div>


Step 3 — Add JavaScript (bottom of page before </body>)

<script>
    function showQuestionResponse(jsonString) {
        try {
            const parsed = JSON.parse(jsonString);
            document.getElementById("qrJsonDisplay").textContent =
                JSON.stringify(parsed, null, 4);
        } catch(e) {
            document.getElementById("qrJsonDisplay").textContent =
                "Invalid JSON:\n\n" + jsonString;
        }

        document.getElementById("qrModal").style.display = "block";
    }

    function closeModal() {
        document.getElementById("qrModal").style.display = "none";
    }

    window.onclick = function(event) {
        const modal = document.getElementById("qrModal");
        if (event.target === modal) {
            closeModal();
        }
    };
</script>


Step 4 — Add Simple CSS (optional but nice)

.modal {
  display:none;
  position:fixed;
  z-index:1000;
  left:0;
  top:0;
  width:100%;
  height:100%;
  background:rgba(0,0,0,0.7);
}

.modal-content {
  background:#fff;
  margin:10% auto;
  padding:20px;
  width:60%;
  max-height:70%;
  overflow:auto;
  border-radius:8px;
}

.close {
  float:right;
  font-size:28px;
  cursor:pointer;
}

.qr-button {
  margin-top:6px;
  padding:6px 10px;
  border-radius:6px;
  background:#008CBA;
  color:white;
  border:none;
  cursor:pointer;
}

.qr-button:hover {
  background:#006f94;
}


<!-- Button to show questionResponse JSON -->
<button type="button"
        class="btn btn-sm btn-outline-secondary mt-1"
        th:if="${img.questionResponse != null and img.questionResponse != ''}"
        th:attr="data-question=${img.questionResponse}"
        onclick="showQuestionResponse(this)">
    Show AI Details
</button>

<!-- Where the JSON will be displayed for this image -->
<div class="question-response mt-2"
     style="display:none; white-space:pre-wrap; font-family:monospace; font-size:12px; background:#f5f5f5; padding:8px; border-radius:4px;"></div>


<script th:inline="javascript">
    function showQuestionResponse(button) {
        const rawJson = button.getAttribute('data-question');
        if (!rawJson) {
            alert('No details available.');
            return;
        }

        let pretty = rawJson;
        try {
            // Try to pretty-print if it’s valid JSON
            pretty = JSON.stringify(JSON.parse(rawJson), null, 2);
        } catch (e) {
            // If it’s not strictly valid JSON, just show the raw string
            console.warn('Could not parse questionResponse as JSON', e);
        }

        // Find the sibling <div> for this card
        const container = button.parentElement.querySelector('.question-response');
        if (!container) {
            alert(pretty);
            return;
        }

        // Toggle display
        if (container.style.display === 'none' || container.style.display === '') {
            container.textContent = pretty;
            container.style.display = 'block';
            button.textContent = 'Hide AI Details';
        } else {
            container.style.display = 'none';
            button.textContent = 'Show AI Details';
        }
    }
</script>
